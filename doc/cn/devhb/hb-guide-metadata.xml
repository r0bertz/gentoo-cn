<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- This document was last synched to:
     cvs://gentoo/gentoo/xml/htdocs/doc/en/metadata.xml :: R1.4.
-->

<sections>
<section>
<title>为什么需要metadata.xml？</title>
<subsection>
<body>

<p>
文件<c>metadata.xml</c>是用来给出ebuilds额外的信息。这个文件应该存在于在每个软件包的文件夹中。文件skel便以<c>skel.metadata.xml</c>的形式存在于portage树中。
</p>

<note>
在提交一个<c>metadata.xml</c>文件之前先运行<c>xmllint --valid metadata.xml</c>。我们希望尽早给给<c>metadata.xml</c>提供支持。
</note>

</body>
</subsection>
</section>

<section>
<title>Metadata的结构</title>
<subsection>
<body>

<p>
一个<c>metadata.xml</c>文件可以包含一些标签：
</p>

<table>
<tr>
  <th>标签</th>
  <th>描述</th>
</tr>
<tr>
  <ti>
    <brite>&lt;pkgmetadata&gt;</brite>
  </ti>
  <ti>
    这是文件metadata.xml的根元素，没有属性。他要求的子元素为：<brite>&lt;herd&gt;</brite>。不久后，也将允许下面的子标签：<brite>&lt;email&gt;</brite>，用作组的email地址，<brite>&lt;maintainer&gt;</brite>, 和<brite>&lt;longdescription&gt;</brite>.
  </ti>
</tr>
<tr>
  <ti>
    <brite>&lt;herd&gt;</brite>
  </ti>
  <ti>
      至少需要有一个子标签。这个标签的内容应该是这个组的由<uri link="http://www.gentoo.org/cgi-bin/viewcvs.cgi/misc/herds.xml?rev=HEAD;cvsroot=gentoo;content-type=text/plain">herds.xml</uri>指定的名称。这个至少要出现一次。
  </ti>
</tr>
<tr>
  <ti>
    <brite>&lt;maintainer&gt;</brite>
  </ti>
  <ti>
  除开作为一个组的成员，一个软件包还可直接管理。一个软件包的维护者可以由标签<brite>&lt;maintainer&gt;</brite>指定。这个标签有一个必须的子标签：<brite>&lt;email&gt;</brite>. 他有两个可选的标签<brite>&lt;name&gt;</brite>和<brite>&lt;description&gt;</brite>。
  </ti>
</tr>
<tr>
  <ti><brite>&lt;email&gt;</brite></ti>
  <ti>
  这里包含维护者的email地址。这个是必须的。
  </ti>
</tr>
<tr>
  <ti><brite>&lt;name&gt;</brite></ti>
  <ti>
  这里包含维护者的名称等一些随意的内容。这个是可选的。
  </ti>
</tr>
<tr>
  <ti><brite>&lt;description&gt;</brite></ti>
  <ti>
  标签description包含维护权的描述，或者是，比如说，一个谁有兴趣取代这个维护权的标记。这也是可选的。
  </ti>
</tr>
<tr>
  <ti><brite>&lt;longdescription&gt;</brite></ti>
  <ti>
  这个标签包含了这个软件包的描述。这增大了ebuilds本身的DESCRIPTION项的内容。
  </ti>
</tr>
</table>

<p>
这还有一些可以用于这些标签的属性。这些都是可选的。
</p>

<table>
<tr>
  <th>属性</th>
  <th>标签</th>
  <th>描述</th>
</tr>
<tr>
  <ti>lang</ti>
  <ti>
    <brite>&lt;description&gt;</brite>, <brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
  通常需要一个描述时，<e>至少</e>有一个英文的描述。如果给出了一个其他语言的描述，这个属性就是用来指定所用的语言。格式为两字节的国家代码。
  </ti>
</tr>
<tr>
  <ti>restrict</ti>
  <ti>
    <brite>&lt;herd&gt;</brite>, <brite>&lt;maintainer&gt;</brite>, 
    <brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
  属性restrict允许来限制某性特定的标签用于该软件特定的版本。当这个属性用到时，不带此属性的标签仍然也需要有。那个没有restrict属性的标签会作为默认值使用。属性restrict的格式与标签DEPEND的格式相同，除开&quot;&lt;&quot;和&quot;&gt;&quot;需要用&amp;lt和&amp;gt来指定。
  <br />
    <br />
    比如在数据库软件包<c>restrict="&gt;=sys-libs/db-3.2.9-r5"</c>中，他的维护者的标签表明我目前维护着所有大于3.2.9-r5的版本。
      </ti>
</tr  >
</table>

</body>
</subsection>
</section>

<section>
<title>Metadata样例</title>
<subsection>
<title>第一个例子</title>
<body>

<p>
在第一个例子中，我们给你看看由<c>openoffice</c>小组全权管理的给OpenOffice用的ebuilds的<path>metadata.xml</path>：
</p>

<pre caption="组管理的软件包">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;openoffice&lt;/herd&gt;
  &lt;longdescription&gt;
    OpenOffice is the  opensource version of staroffice.
    This ebuild allows you to compile it yourself. Unfortunately this
    compilation can take up to a day depending on the speed of your
    computer. It will however make a snappier openoffice than the binary
    version.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

<p>
<c>openoffice</c>组在<uri link="/proj/en/metastructure">Gentoo Metastructure Project</uri>的文件<path>herds.xml</path>中所定义：
</p>

<note>
当你读到这个的时候，这个例子可能已经过时了。这只是一个例子！
</note>

<pre caption="OpenOffice组的例子">
&lt;herd&gt;
  &lt;name&gt;openoffice&lt;/name&gt;
  &lt;email&gt;openoffice@gentoo.org&lt;/email&gt;
  &lt;description&gt;openoffice related packages&lt;/description&gt;
  &lt;maintainer&gt;&lt;email&gt;pauldv@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
  &lt;maintainer&gt;&lt;email&gt;brad@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
&lt;/herd&gt;
</pre>

<p>
如果你要将自己加入（退出）一个组，编辑位于Gentoo CVS仓库的<path>[gentoo]/misc</path>中的文件<path>herds.xml</path>。确认你知道这个组所属的email别名（如“sound”组有<mail link="sound@gentoo.org">sound@gentoo.org</mail>），并将你添加到这个别名中（通过编辑<path>/var/mail/alias/misc/&lt;alias name&gt;</path>）。
</p>

</body>
</subsection>
<subsection>
<title>第二个例子</title>
<body>

<p>
作为第二个例子，我们来看看<c>mirrorselect</c>的<path>metadata.xml</path>。这个ebuild由<c>tools-portage</c>组维护，但是却有一个单独的维护者。
</p>

<pre caption="组和个人维护的软件包">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;tools-portage&lt;/herd&gt;
  &lt;maintainer&gt;
    &lt;email&gt;johnm@gentoo.org&lt;/email&gt;
    &lt;name&gt;John Mylchreest&lt;/name&gt;
  &lt;/maintainer&gt;
  &lt;longdescription&gt;
    This utility is used to select the fastest mirror (distfiles) and provide a
    nicer front-end for mirror selection (both rsync + distfiles) to a user.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

</body>
</subsection>
</section>
</sections>
