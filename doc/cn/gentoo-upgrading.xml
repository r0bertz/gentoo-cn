<?xml version='1.0' encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/guide.xsl" ?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/www/www.gentoo.org/raw_cvs/gentoo/xml/htdocs/doc/en/gentoo-upgrading.xml,v 1.4 2004/07/01 00:48:49 neysx Exp $ -->

<guide link="/doc/zh_cn/gentoo-upgrading.xml">
<title>Gentoo升级指南</title>

<author title="Author">
  <mail link="g.guidi@sns.it">Gregorio Guidi</mail>
</author>
<author title="Translator">
  <mail link="joanphan@gmail.com">Hans Joanphan</mail>
</author>

<abstract>
这篇文档解释了一个新的Gentoo发行版发行后，你该做出的反应。
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->
<license/>

<version>1.2</version>
<date>July 1, 2004</date>

<chapter>
<title>Gentoo和升级</title>
<section>
<title>哲学</title>
<body>

<p>
在Gentoo的世界里，升级的概念相对其他的linux世界来说很不一样。很可能你已经知道了，我们从不会在我们的发行版中用“经典”的办法来升级软件到最新的版本：等待一个新的发行版，下载，刻录，将光盘放进光驱然后根据升级说明来做。
</p>

<p>
你也知道（毕竟你选择了Gentoo），升级这个过程令一些生活在边缘地带的高级用户来感到非常挫折。就是其他发行版的高级用户也会有同样的感受，尽管他们有能够可以常常快速更新的apt或者apt-rpm这样流行的工具。不管怎么说，没有一个发行版能像Gentoo一样来满足这些用户的需求，因为Gentoo诞生初期就是从快速和逐增的更新概念开始的。
</p>

<p>
理想情况下，你安装一次Gentoo后就不需再为新的发行而烦恼，只需要按照<uri link="/doc/zh_cn/handbook/">Gentoo Handbook</uri>里的<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=2">Portage和软件</uri>的说明来保持你的系统更新。这是通常情况下我们经常做的，有时候开发者在推出一个新的发行时对系统的一些底层也进行了一些更新，这时候就不一样了。我们在讨论系统配置（profile）时将会考虑到这些情况。
</p>

</body>
</section>
<section>
<title>发行和系统配置（profile）</title>
<body>

<p>
一个有关Gentoo发行过程的常见问题时：“他们又不是让用户更新软件，为什么高频率的推出新版本？”。这里有很多原因：
</p>

<ul>
  <li>
    一个新的发行意味着性能更强和更丰富的LiveCD。
  </li>
  <li>
    一个新的发行提供一系列的GRP软件升级包，这样选择快速安装、使用stage3和预编译软件包的用户可以对系统进行更新。
  </li>
  <li>
    最后，一个新的发行可能（不是常常如此）实现和以前发行不兼容的特性。
  </li>
</ul>

<p>
如果一个发行提供了不兼容的特性，或者提供了一系列对系统运转修改很大的核心软件包或者设置，或者只是对一些默认的参数进行修改，我们就说这个发行提供了一个新的<e>系统配置（profile）</e>。
</p>

<p>
一个<e>系统配置</e>是一系列的配置文件，存放在<path>/usr/portage/profiles/</path>里的一个子文件夹里，主要描述了如作为<e>system</e>软件包的ebuilds、默认的USE参数和虚拟软件包的默认映射等。
</p>

<p>
系统配置的使用是通过符号链接<path>/etc/make.profile</path>来进行的，这个符号链接指向<path>/usr/portage/profiles</path>的子文件夹，这里存放了如<path>/usr/portage/profiles/default-x86-2004.0</path>（旧风格的位置）或者<path>/usr/portage/profiles/default-linux/x86/2004.0</path>（新风格的位置）之类的文件。对于新风格的系统配置的文件夹，我们注意到在其上级文件夹的文件也是系统配置的一部分（他们也因此被不同的系统配置所共享使用）。
</p>

<p>
被新的所废弃的系统配置作为当前系统配置放置在<path>/usr/portage/profiles</path>里，但是会被标记为不赞成使用的。如果这样，一个名叫<path>deprecated</path>的文件将会放在这个系统配置文件夹里。这个文件的内容是应该标记的系统配置的名字；Portage将会使用这条信息来自动警告你有关新的系统配置。
</p>

<p>
有很多原因都可以决定一个新的系统配置的产生：核心软件包（如<c>baselayout</c>、<c>gcc</c>或者<c>glibc</c>）的新版的发行与以前版本不兼容，或者默认USE参数的改变，或者虚拟映射的改变，或者一个系统范围内设置的改变（如定义udev取代devfs作为<path>/dev</path>的默认管理器）。
</p>

</body>
</section>
</chapter>

<chapter>
<title>和新的发行保持同步</title>
<section>
<title>系统配置不改变的发行</title>
<body>

<p>
如果一个新的Gentoo发行声明其没有包括一个新的系统配置（如x86架构的2004.1版），那你可以安全的认为什么事都没发生过。
</p>

<p>
如果你更新你已安装<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=2">如Gentoo手册中解释过的</uri>软件包，那你的系统将会同一个使用新的Gentoo发行安装的一模一样。
</p>

</body>
</section>
<section>
<title>系统配置改变的发行</title>
<body>

<p>
如果一个发行引入一个新的系统配置，你可以移植你的到新的系统配置。
</p>

<p>
当然，你不是非得这样做，你可以继续使用就得配置文件和更新你的<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=2">如Gentoo手册中解释过的</uri>软件包（或者你可以根本不更新你的系统）。
</p>

<p>
但是，如果你的系统配置已经不再赞成使用也不再被Gentoo开发者所支持，也就是说你的系统配置不再列在下面的表中，强烈推荐对你的系统配置进行移植。
</p>

<p>
如果你已经决定将系统配置移植到一个新的，你还将必须手动做一些工作。这些工作可能根据不同的发行变化很大，这完全取决于一个新的系统配置到底有多大的修改。
</p>

<p>
最简单的情况下，你只需改变<path>/etc/make.profile</path>这个链接；最麻烦的时候，如果做了一些voodoo stuff，你得重新编译你的系统。我们每次都会将移植的说明作为发行的一部分公布。你可以在这篇指南的后面找到这些说明。
</p>

</body>
</section>
<section>
<title>支持的系统配置文件</title>
<body>

<p>
下面系统配置文件是被Gentoo开发者所正式支持的：
</p>

<table>
<tr>
  <th>架构</th>
  <th>最新的系统配置</th>
  <th>其他的系统配置</th>
</tr>
<tr>
  <th>x86</th>
  <ti>2004.0</ti>
  <ti>1.4</ti>
</tr>
<tr>
  <th>hardened-x86</th>
  <ti>2004.0</ti>
  <ti></ti>
</tr>
<tr>
  <th>amd64</th>
  <ti>2004.0</ti>
  <ti></ti>
</tr>
<tr>
  <th>ppc</th>
  <ti>2004.0</ti>
  <ti></ti>
</tr>
<tr>
  <th>sparc</th>
  <ti>2004.0</ti>
  <ti>1.4</ti>
</tr>
<tr>
  <th>mips</th>
  <ti>2004.0</ti>
  <ti>1.4</ti>
</tr>
<tr>
  <th>hppa</th>
  <ti>2004.0</ti>
  <ti></ti>
</tr>
</table>

</body>
</section>
</chapter>

<chapter>
<title>系统配置更新说明</title>
<section>
<title>从1.4升级到2004.0（所有架构）</title>
<body>

<p>
1.4和2004.0之间的系统配置文件没有基本的变化。只不过<path>/etc/make.profile</path>指向了一个新的位置：
</p>

<pre caption="更新/etc/make.profile的链接">
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/default-linux/x86/2004.0 /etc/make.profile</i>
</pre>

</body>
</section>
<section>
<title>从低于1.4版本升级到1.4</title>
<body>

<p>
这个升级的说明很复杂，你可以参看<uri link="new-upgrade-to-gentoo-1.4.xml">这里</uri>。
</p>

</body>
</section>
</chapter>

</guide>

